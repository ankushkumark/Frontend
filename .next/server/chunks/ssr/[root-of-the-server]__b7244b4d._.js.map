{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///E:/New/Frontend/my-app/src/app/profile/page.js"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\n\r\nexport default function ProfilePage() {\r\n  const [profile, setProfile] = useState({\r\n    fullName: \"\",\r\n    email: \"\",\r\n    phone: \"\",\r\n    photo: null,\r\n  });\r\n\r\n  const [userId, setUserId] = useState(null);\r\n\r\n  // ‚úÖ Login ke baad userId localStorage me save karna hoga\r\n  useEffect(() => {\r\n  const storedUser = JSON.parse(localStorage.getItem(\"user\"));\r\n  console.log(\"storedUser:\", storedUser);\r\n\r\n  if (storedUser?._id) {\r\n    setUserId(storedUser._id);\r\n    fetchUser(storedUser._id);\r\n  }\r\n}, []);\r\n\r\n\r\n\r\n  // ‚úÖ API se user ka data fetch\r\n  // ‚úÖ API se user ka data fetch\r\nconst fetchUser = async () => {\r\n  try {\r\n    const token = localStorage.getItem(\"token\");\r\n    const res = await axios.get(\"http://localhost:5000/api/user/me\", {\r\n      headers: { Authorization: `Bearer ${token}` }\r\n    });\r\n\r\n    const user = res.data;\r\n\r\n    setProfile({\r\n      fullName: user.name,\r\n      email: user.email,\r\n      phone: user.phone || \"\",\r\n      photo: user.profilePic || null, // üëà yeh add karo\r\n    });\r\n\r\n    // ‚úÖ LocalStorage update bhi karo (Sidebar/Profile ke liye)\r\n    if (user.name) localStorage.setItem(\"name\", user.name);\r\n    if (user.email) localStorage.setItem(\"email\", user.email);\r\n    if (user.profilePic) localStorage.setItem(\"avatar\", user.profilePic);\r\n\r\n  } catch (err) {\r\n    console.error(err);\r\n    alert(\"Failed to fetch profile\");\r\n  }\r\n};\r\n\r\n\r\n\r\n\r\n\r\n  // ‚úÖ Input change handler\r\n  const handleInputChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setProfile((prev) => ({ ...prev, [name]: value }));\r\n  };\r\n\r\n  // ‚úÖ File change handler\r\n  const handleFileChange = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      setProfile((prev) => ({ ...prev, photo: file }));\r\n    }\r\n  };\r\n\r\n  // ‚úÖ Profile update handler\r\n// ‚úÖ Profile update handler\r\nconst handleUpdate = async () => {\r\n  try {\r\n    const token = localStorage.getItem(\"token\"); // üëà login/signup ke baad save hota hai\r\n\r\n    const res = await axios.put(\r\n      \"http://localhost:5000/api/user/update\",\r\n      {\r\n        name: profile.fullName,\r\n        phone: profile.phone,\r\n      },\r\n      {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`, // üëà JWT token send karna hoga\r\n        },\r\n      }\r\n    );\r\n\r\n    const updatedUser = res.data?.user;\r\n    if (updatedUser) {\r\n      // üîπ Local state update\r\n      setProfile((prev) => ({\r\n        ...prev,\r\n        fullName: updatedUser.name || prev.fullName,\r\n        phone: updatedUser.phone || prev.phone,\r\n      }));\r\n\r\n      // üîπ LocalStorage update (Sidebar ke liye)\r\n      if (updatedUser.name) localStorage.setItem(\"name\", updatedUser.name);\r\n      if (updatedUser.email) localStorage.setItem(\"email\", updatedUser.email);\r\n      if (updatedUser.profilePic) localStorage.setItem(\"avatar\", updatedUser.profilePic);\r\n    }\r\n\r\n    alert(\"‚úÖ Profile updated successfully\");\r\n  } catch (err) {\r\n    console.error(\"Update error:\", err.response?.data || err.message);\r\n    alert(\"‚ùå Failed to update profile\");\r\n  }\r\n};\r\n\r\n// ‚úÖ Profile photo upload handler\r\nconst handleProfileUpload = async () => {\r\n  if (!profile.photo || !(profile.photo instanceof File)) {\r\n    alert(\"Please select a new profile picture first\");\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const token = localStorage.getItem(\"token\");\r\n    const formData = new FormData();\r\n    formData.append(\"profile\", profile.photo);\r\n\r\n    const res = await axios.post(\r\n      \"http://localhost:5000/api/user/upload-profile\",\r\n      formData,\r\n      {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n          \"Content-Type\": \"multipart/form-data\",\r\n        },\r\n      }\r\n    );\r\n\r\n    const updatedUser = res.data?.user;\r\n    if (updatedUser) {\r\n      // üîπ Local state update\r\n      setProfile((prev) => ({\r\n        ...prev,\r\n        photo: updatedUser.profilePic || prev.photo, // ‚úÖ backend se updated image path\r\n      }));\r\n      // üîπ LocalStorage update (for Sidebar)\r\n      if (updatedUser.name) localStorage.setItem(\"name\", updatedUser.name);\r\n      if (updatedUser.email) localStorage.setItem(\"email\", updatedUser.email);\r\n      if (updatedUser.profilePic) localStorage.setItem(\"avatar\", updatedUser.profilePic);\r\n    }\r\n\r\n    alert(\"‚úÖ Profile picture uploaded successfully\");\r\n  } catch (err) {\r\n    console.error(\"Upload error:\", err.response?.data || err.message);\r\n    alert(\"‚ùå Failed to upload profile picture\");\r\n  }\r\n};\r\n  return (\r\n    <div className=\"p-6 md:p-10\">\r\n      <div className=\"bg-white shadow-md rounded-lg p-6 w-full max-w-4xl mx-auto\">\r\n        {/* Tabs */}\r\n        <div className=\"flex border-b border-gray-200 mb-6\">\r\n          <Link\r\n            href=\"/profile\"\r\n            className=\"px-4 py-2 text-sm font-medium text-teal-600 border-b-2 border-teal-600\"\r\n          >\r\n            Account\r\n          </Link>\r\n          <Link\r\n            href=\"/profile/security\"\r\n            className=\"px-4 py-2 text-sm font-medium text-gray-500 hover:text-gray-700\"\r\n          >\r\n            Security\r\n          </Link>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n          {/* Left side form */}\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <label className=\"block text-sm text-gray-500\">Full name</label>\r\n              <input\r\n                type=\"text\"\r\n                name=\"fullName\"\r\n                value={profile.fullName}\r\n                onChange={handleInputChange}\r\n                className=\"mt-1 w-full px-3 py-2 border rounded-md text-gray-700\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm text-gray-500\">Email</label>\r\n              <input\r\n                type=\"email\"\r\n                name=\"email\"\r\n                value={profile.email}\r\n                 disabled // ‚úÖ isse readonly ho jayega\r\n                className=\"mt-1 w-full px-3 py-2 border rounded-md text-gray-700\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm text-gray-500\">Phone Number</label>\r\n              <input\r\n                type=\"text\"\r\n                name=\"phone\"\r\n                value={profile.phone}\r\n                onChange={handleInputChange}\r\n                className=\"mt-1 w-full px-3 py-2 border rounded-md text-gray-700\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Right side - Profile Picture */}\r\n          <div className=\"flex flex-col items-center justify-center\">\r\n            <label className=\"block text-sm text-gray-500 mb-2\">\r\n              Your Profile Picture\r\n            </label>\r\n            <div className=\"w-32 h-32 border-2 border-dashed border-gray-300 flex items-center justify-center rounded-md relative\">\r\n              {profile.photo && !(profile.photo instanceof File) ? (\r\n                <img\r\n                  src={`http://localhost:5000/${profile.photo}`}\r\n                  alt=\"Profile\"\r\n                  className=\"w-full h-full object-cover rounded-md\"\r\n                />\r\n              ) : profile.photo instanceof File ? (\r\n                <img\r\n                  src={URL.createObjectURL(profile.photo)}\r\n                  alt=\"Preview\"\r\n                  className=\"w-full h-full object-cover rounded-md\"\r\n                />\r\n              ) : (\r\n                <span className=\"text-sm text-gray-400\">Upload your photo</span>\r\n              )}\r\n              <input\r\n                type=\"file\"\r\n                accept=\"image/*\"\r\n                onChange={handleFileChange}\r\n                className=\"absolute inset-0 opacity-0 cursor-pointer\"\r\n              />\r\n            </div>\r\n            {/* Upload button */}\r\n<div className=\"mt-4\">\r\n  <button\r\n    type=\"button\"\r\n    onClick={handleProfileUpload}\r\n    className=\"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700\"\r\n  >\r\n    Upload Profile Picture\r\n  </button>\r\n</div>\r\n\r\n          </div>\r\n        </div>\r\n\r\n        {/* Update button */}\r\n        <div className=\"mt-6\">\r\n          <button\r\n          type=\"button\"\r\n            onClick={handleUpdate}\r\n            className=\"px-6 py-2 bg-teal-600 text-white rounded-md hover:bg-teal-700\"\r\n          >\r\n            Update Profile\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}