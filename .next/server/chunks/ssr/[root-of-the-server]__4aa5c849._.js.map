{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/lenovo/OneDrive/Desktop/New/Frontend/my-app/src/app/profile/page.js"],"sourcesContent":["\"use client\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n  IconOverview,\r\n  IconBalances,\r\n  IconTransactions,\r\n  IconBills,\r\n  IconExpenses,\r\n  IconGoals,\r\n  IconSettings,\r\n  IconLogout,\r\n  IconDots,\r\n  IconClose,\r\n} from \"@/sidebar/Icons\";\r\n\r\nimport MenuItem from \"@/sidebar/MenuItem\";\r\nimport { toggleSidebar, closeSidebar } from \"@/store/slices/uiSlice\";\r\nimport Image from \"next/image\";\r\nimport { useRouter, useSearchParams } from \"next/navigation\"; \r\nimport { useEffect, useState } from \"react\";\r\n\r\nconst MENU = [\r\n  { label: \"Overview\", icon: <IconOverview /> },\r\n  { label: \"Balances\", icon: <IconBalances /> },\r\n  { label: \"Transactions\", icon: <IconTransactions />, path: \"/transactions\" },\r\n  { label: \"Bills\", icon: <IconBills />, path: \"/bills\" },\r\n  { label: \"Expenses\", icon: <IconExpenses />, path: \"/expenses\" },\r\n  { label: \"Goals\", icon: <IconGoals />,  path: \"/expenses/linegraph\"},\r\n  { label: \"Settings\", icon: <IconSettings />, path: \"/profile\"},\r\n];\r\n\r\nexport default function Sidebar() {\r\n  const dispatch = useDispatch();\r\n  const { sidebarOpen } = useSelector((s) => s.ui);\r\n  const router = useRouter(); \r\n  const searchParams = useSearchParams();\r\n\r\n  const [user, setUser] = useState(null);\r\n\r\n  // ðŸ‘‡ logout\r\n  const handleLogout = () => {\r\n    localStorage.removeItem(\"token\"); \r\n    localStorage.removeItem(\"name\");\r\n    localStorage.removeItem(\"email\");\r\n    localStorage.removeItem(\"user\");\r\n    document.cookie = \"token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;\";\r\n    router.replace(\"/login\"); \r\n  };\r\n\r\n  // ðŸ‘‡ First check query params (Google callback ke baad)\r\n  useEffect(() => {\r\n    const token = searchParams.get(\"token\");\r\n    const name = searchParams.get(\"name\");\r\n    const email = searchParams.get(\"email\");\r\n\r\n    if (token) {\r\n      localStorage.setItem(\"token\", token);\r\n      if (name) localStorage.setItem(\"name\", name);\r\n      if (email) localStorage.setItem(\"email\", email);\r\n\r\n      const userObj = { name, email };\r\n      setUser(userObj);\r\n      localStorage.setItem(\"user\", JSON.stringify(userObj));\r\n\r\n      // âœ… Clean URL se query params hata do\r\n      window.history.replaceState({}, document.title, \"/\");\r\n    }\r\n  }, [searchParams]);\r\n\r\n  // ðŸ‘‡ Load user from localStorage (agar direct refresh kare)\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"token\");\r\n    const storedUser = localStorage.getItem(\"user\");\r\n\r\n    if (token && storedUser) {\r\n      setUser(JSON.parse(storedUser));\r\n    } else if (token) {\r\n      // fallback: backend call\r\n      const fetchUser = async () => {\r\n        try {\r\n          const res = await fetch(\"http://localhost:5000/api/auth/me\", {\r\n            headers: { Authorization: `Bearer ${token}` },\r\n          });\r\n          if (res.ok) {\r\n            const data = await res.json();\r\n            setUser(data);\r\n            localStorage.setItem(\"user\", JSON.stringify(data));\r\n          }\r\n        } catch (err) {\r\n          console.error(\"Failed to fetch user:\", err);\r\n        }\r\n      };\r\n      fetchUser();\r\n    }\r\n  }, []);\r\n\r\n  // ðŸ‘‡ Listen for localStorage changes (update live after profile change)\r\n  useEffect(() => {\r\n    const syncUser = () => {\r\n      const storedUser = localStorage.getItem(\"user\");\r\n      if (storedUser) {\r\n        setUser(JSON.parse(storedUser));\r\n      }\r\n    };\r\n\r\n    window.addEventListener(\"storage\", syncUser);\r\n    return () => window.removeEventListener(\"storage\", syncUser);\r\n  }, []);\r\n\r\n  return (\r\n    <>\r\n      {/* Mobile hamburger button */}\r\n      <button\r\n        onClick={() => dispatch(toggleSidebar())}\r\n        className=\"lg:hidden fixed top-3 left-3 z-50 bg-white text-gray-900 rounded-xl shadow-md p-2\"\r\n      >\r\n      </button>\r\n\r\n      {/* Overlay for mobile */}\r\n      {sidebarOpen && (\r\n        <div\r\n          className=\"lg:hidden fixed inset-0 bg-black/40 z-40\"\r\n          onClick={() => dispatch(closeSidebar())}\r\n        />\r\n      )}\r\n\r\n      {/* Sidebar */}\r\n      <aside\r\n        className={`fixed top-0 left-0 z-50 w-64 h-screen bg-[#0f141a] text-slate-300 border-r border-[#1f2937]\r\n        grid grid-rows-[auto_1fr_auto] p-5 overflow-y-auto\r\n        transform transition-transform duration-300\r\n        ${sidebarOpen ? \"translate-x-0\" : \"-translate-x-full lg:translate-x-0\"}`}\r\n      >\r\n        {/* Mobile brand header */}\r\n        <div className=\"flex items-center justify-between mb-4 lg:hidden\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"w-3.5 h-3.5 rounded bg-gradient-to-br from-teal-500 to-sky-500 ring-4 ring-[#0f141a]\" />\r\n            <span className=\"text-lg font-bold tracking-wide\">XpenseTrakr</span>\r\n          </div>\r\n          <button\r\n            onClick={() => dispatch(closeSidebar())}\r\n            className=\"text-slate-300 hover:text-white\"\r\n          >\r\n            <IconClose />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Desktop brand header */}\r\n        <div className=\"hidden lg:flex items-center gap-3 mb-4\">\r\n          <div className=\"w-3.5 h-3.5 rounded bg-gradient-to-br from-teal-500 to-sky-500 ring-4 ring-[#0f141a]\" />\r\n          <span className=\"text-lg font-bold tracking-wide\">XpenseTrakr</span>\r\n        </div>\r\n\r\n        {/* Menu */}\r\n        <nav className=\"flex flex-col gap-2\" aria-label=\"Main menu\">\r\n          {MENU.map((m) => (\r\n            <div\r\n              key={m.label}\r\n              onClick={() => m.path && router.push(m.path)} \r\n            >\r\n              <MenuItem label={m.label} icon={m.icon} />\r\n            </div>\r\n          ))}\r\n        </nav>\r\n\r\n        {/* Bottom section */}\r\n        <div className=\"mt-4 flex flex-col gap-3\">\r\n          {/* Logout button */}\r\n          <button\r\n            onClick={handleLogout} \r\n            className=\"flex items-center gap-2 w-full bg-[#0e1319] border border-[#1f2937] text-slate-200 px-3 py-2 rounded-xl hover:bg-[#1a1f25] transition\"\r\n          >\r\n            <span className=\"text-slate-400\"><IconLogout /></span>\r\n            <span className=\"truncate\">Logout</span>\r\n          </button>\r\n\r\n          {/* Profile Card */}\r\n          <div className=\"flex items-center gap-3 bg-[#161b22] border border-[#1f2937] rounded-xl p-2\">\r\n            {/* Avatar */}\r\n            <div className=\"w-9 h-9 overflow-hidden rounded-full shrink-0\">\r\n              <Image\r\n                src={\r\n                  user?.profilePic\r\n                    ? `http://localhost:5000${user.profilePic}`\r\n                    : `https://api.dicebear.com/7.x/initials/svg?seed=${user?.name || \"User\"}`\r\n                }\r\n                alt={user?.name || \"User\"}\r\n                width={36}\r\n                height={36}\r\n              />\r\n            </div>\r\n\r\n            {/* User Info */}\r\n            <div className=\"flex flex-col min-w-0 leading-tight\">\r\n              <span className=\"text-sm font-semibold text-white truncate max-w-[140px]\">\r\n                {user?.name || \"Guest User\"}\r\n              </span>\r\n              <span className=\"text-xs text-slate-400 truncate max-w-[140px]\">\r\n                {user?.email || \"No email\"}\r\n              </span>\r\n            </div>\r\n\r\n            {/* Options button */}\r\n            <button className=\"ml-auto text-slate-400 hover:text-white\">\r\n              <IconDots />\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </aside>\r\n\r\n      {/* Right content wrapper */}\r\n      <main className=\"flex-1 lg:ml-64 p-4\"></main>\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}